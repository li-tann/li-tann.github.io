<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-code/cmake/mastering_cmake" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.1">
<title data-rh="true">Mastering CMake | li-tann</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://li-tann.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://li-tann.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://li-tann.github.io/docs/code/cmake/mastering_cmake"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Mastering CMake | li-tann"><meta data-rh="true" name="description" content="Mastering CMake study notes"><meta data-rh="true" property="og:description" content="Mastering CMake study notes"><link data-rh="true" rel="icon" href="/img/SAR-LOGO2.png"><link data-rh="true" rel="canonical" href="https://li-tann.github.io/docs/code/cmake/mastering_cmake"><link data-rh="true" rel="alternate" href="https://li-tann.github.io/docs/code/cmake/mastering_cmake" hreflang="en"><link data-rh="true" rel="alternate" href="https://li-tann.github.io/docs/code/cmake/mastering_cmake" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="li-tann RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="li-tann Atom Feed">




<link rel="stylesheet" href="/katex/katex.min.css"><link rel="stylesheet" href="/assets/css/styles.81049be4.css">
<script src="/assets/js/runtime~main.939d6a14.js" defer="defer"></script>
<script src="/assets/js/main.c637cd9e.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/SAR-LOGO2.png" alt="Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/SAR-LOGO2.png" alt="Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">li-tann&#x27;s Notebook</b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/intro">💬Document</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/code/intro">🧙Code</a><a class="navbar__item navbar__link" href="/blog">🏷️Blog</a><a href="https://github.com/li-tann/li-tann.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">🚀GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="navbarSearchContainer_Bca1"></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/"><img src="/img/SAR-LOGO2.png" alt="Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/SAR-LOGO2.png" alt="Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"><b>li-tann&#x27;s Notebook</b></a><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/code/intro">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/cpp">Cpp</a><button aria-label="Expand sidebar category &#x27;Cpp&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/cpp-qt">Cpp Qt</a><button aria-label="Expand sidebar category &#x27;Cpp Qt&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/cmake">CMake</a><button aria-label="Collapse sidebar category &#x27;CMake&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/code/cmake/mastering_cmake">Mastering CMake</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/code/cmake/cmake_find_package">find_package</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/code/cmake/cmake_list">LIST</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/code/cmake/cmake_vscode+mingw">VSCode MinGW</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/code/cmake/launch_vs_json">VisualStudio</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/code/cmake/vscode_cmake">VSCode Vcpkg</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/python">Python</a><button aria-label="Expand sidebar category &#x27;Python&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/cuda">CUDA</a><button aria-label="Expand sidebar category &#x27;CUDA&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/shell">Shell</a><button aria-label="Expand sidebar category &#x27;Shell&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/cmake"><span itemprop="name">CMake</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Mastering CMake</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Mastering CMake</h1></header><p><em>Mastering CMake</em> study notes</p>
<p><a href="https://cmake.org/cmake/help/book/mastering-cmake/index.html" target="_blank" rel="noopener noreferrer">Mastering CMake</a></p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="getting-started">Getting Started<a href="#getting-started" class="hash-link" aria-label="Direct link to Getting Started" title="Direct link to Getting Started">​</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="hello-world-for-cmake">Hello World for CMake<a href="#hello-world-for-cmake" class="hash-link" aria-label="Direct link to Hello World for CMake" title="Direct link to Hello World for CMake">​</a></h3>
<p><code>cmake_minimum_required</code>, the first line of the top level CMakeLists file should always be.</p>
<p>This allows projects to require a given <strong>version of CMake</strong> and, in addition, allows CMake to be <strong>backwards compatible(向后兼容)</strong>.</p>
<p>设定CMake版本并且支持向后兼容</p>
<p><code>project</code>, the next line of any top level CMakeLists file should be.</p>
<p>This command sets <strong>the name of the project</strong> and <strong>may specify other options</strong> such as language or version.</p>
<p>设置工程名称, 也可以设置语言、版本等其他信息（后面应该会有详细说明）</p>
<p>The project will contain all targets that are in the CMakeLists.txt file and any subdirectories, as specified by the <code>add_subdirectory</code> command.(If the <code>EXCLUDE_FROM_ALL</code> option is used in the <code>add_subdirectory</code> command, the generated project will not appear in the top-level Makefile or IDE project file; this is useful for generating sub-projects that do not make sense as part of the main build process.)</p>
<p>project会链接所有的targets, 包括通过<code>add_subdirectory</code>添加的子目录, 除非在子目录中设置<code>EXCLUDE_FROM_ALL</code>。</p>
<p><code>add_executable</code>, be used to add an executable to the project using the given source file.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="configure-and-generate">Configure and Generate<a href="#configure-and-generate" class="hash-link" aria-label="Direct link to Configure and Generate" title="Direct link to Configure and Generate">​</a></h3>
<p>After a CMakeLists file has been created, CMake processes the text file and creates entries in a cache file. Users may edit the CMakeLists file or specify cache values with the CMake gui or ccmake and re-configure. Next, CMake uses the cache entries to generate a project in the user’s desired build system (e.g. Makefile or Visual Studio solution).</p>
<p>写好CMakeLists.txt后，就需要配置和生成项目，可以通过gui/command等多种途径。但是在配置前还需要进行一些设置, 例如构建目录、设置编译器等。</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="specifying-the-compiler-to-cmake">Specifying the Compiler to CMake<a href="#specifying-the-compiler-to-cmake" class="hash-link" aria-label="Direct link to Specifying the Compiler to CMake" title="Direct link to Specifying the Compiler to CMake">​</a></h3>
<p>The <code>CC</code> environment variable specifies the C compiler, while <code>CXX</code> specifies the C++ compiler.You can specify the compilers directly on the command line by using <code>-DCMAKE_CXX_COMPILER=cl</code> for example.</p>
<p>Once cmake has been run and picked a compiler, if you wish to change the compiler, start over with <strong>an empty binary directory</strong>.</p>
<p>The flags for the compiler and the linker can also be changed by setting environment variables. Setting <code>LDFLAGS</code> will initialize the cache values for link flags, while <code>CXXFLAGS</code> and <code>CFLAGS</code> will initialize <code>CMAKE_CXX_FLAGS</code> and <code>CMAKE_C_FLAGS</code> respectively.</p>
<p>通过<code>-DCMAKE_CXX_COMPILER=cl</code>命令可以设置C++编译器为cl(不过在VSCode、VisualStudio等具备CMake相关组件的IDE中, 都具有可视化的编译器设置选项)。</p>
<p><img loading="lazy" alt="vscode, set compiler" src="/assets/images/cmake_vscode_set_complier-06b88be1f660c739f3b9918dccc927a9.png" width="1188" height="51" class="img_ev3q"></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="build-configurations">Build Configurations<a href="#build-configurations" class="hash-link" aria-label="Direct link to Build Configurations" title="Direct link to Build Configurations">​</a></h3>
<p>Build configurations allow a project to be built in different ways for debug, optimized, or any other special set of flags. CMake supports, by <strong>default</strong>, <strong>Debug</strong>, <strong>Release</strong>, <strong>MinSizeRel</strong>, and <strong>RelWithDebInfo</strong> configurations.</p>
<ul>
<li>Debug has the basic debug flags turned on.</li>
<li>Release has the basic optimizations turned on.</li>
<li>MinSizeRel has flags that produce the smallest object code, but not necessarily the fastest code.</li>
<li>RelWithDebInfo builds an optimized build with debug information as well.</li>
</ul>
<p>CMake handles the configurations in slightly different ways depending on the generator being used.</p>
<p>但不同的generator，可能使CMake在处理配置的方法略有不同。</p>
<p>The Visual Studio IDE supports the notion of Build Configurations. A default project in Visual Studio usually has Debug and Release configurations. From the IDE you can select build Debug, and the files will be built with Debug flags. The IDE puts all of the binary files into directories with the name of the active configuration. This brings about an extra complexity for projects that build programs that need to be run as part of the build process from custom commands.</p>
<p>这一段不是很理解...</p>
<p>With Makefile-based generators, only one configuration can be active at the time CMake is run, and it is specified with the CMAKE_BUILD_TYPE variable。</p>
<p>构建项目时，可以通过<code>-DCMAKE_BUILD_TYPE=Debug/Release</code>来指定构建类型。</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="building-your-project">Building Your Project<a href="#building-your-project" class="hash-link" aria-label="Direct link to Building Your Project" title="Direct link to Building Your Project">​</a></h3>
<p>Another option is to use cmake’s <code>--build</code> option from the command line. This option is simply a convenience that allows you to build your project from the command line, even if that requires launching an IDE.</p>
<p><code>cmake --build _build</code>, 在<code>./_build</code>文件夹中构建项目。</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="总结">总结<a href="#总结" class="hash-link" aria-label="Direct link to 总结" title="Direct link to 总结">​</a></h3>
<p>写CMakeLists.txt时, 最基础的文件应包含<code>cmake_minimum_required(VERSION 3.26.0)</code>和<code>project(name)</code>, 通过<code>add_executable(exe_name hello_world.cpp)</code> 来添加可执行文件。</p>
<p>在编译和构建CMake项目时, 可以通过<code>-DCMAKE_CXX_COMPILER=&lt;complier&gt;</code> 设置编译器, 通过<code>-DCMAKE_BUILD_TYPE=&lt;build_type&gt;</code>设置编译类型, 通过<code>--build</code>设置编译目录。</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="writing-cmakelists-files">Writing CMakeLists Files<a href="#writing-cmakelists-files" class="hash-link" aria-label="Direct link to Writing CMakeLists Files" title="Direct link to Writing CMakeLists Files">​</a></h2>
<p>The CMake language is composed of <strong>comments(注释)</strong>, <strong>commands(命令)</strong>, and <strong>variables(变量)</strong>.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="comments注释">Comments(注释)<a href="#comments注释" class="hash-link" aria-label="Direct link to Comments(注释)" title="Direct link to Comments(注释)">​</a></h3>
<p>Comments start with # and run to the end of the line. See the <a href="https://cmake.org/cmake/help/latest/manual/cmake-language.7.html" target="_blank" rel="noopener noreferrer">cmake-language</a> manual for more details.</p>
<p>在CMakeLists文件中,由<code>#</code>起始的行为注释行</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="variables变量">variables(变量)<a href="#variables变量" class="hash-link" aria-label="Direct link to variables(变量)" title="Direct link to variables(变量)">​</a></h3>
<p>CMakeLists files use variables much like any programming language. CMake variable names are <strong>case sensitive(大小写敏感)</strong> and may only contain <strong>alphanumeric characters字母字符</strong> and <strong>下划线</strong>.</p>
<p>A number of useful variables are automatically defined by CMake and are discussed in the <a href="https://cmake.org/cmake/help/latest/manual/cmake-variables.7.html" target="_blank" rel="noopener noreferrer">cmake-variables</a> manual. These variables begin with <code>CMAKE_</code>. Avoid this naming convention (and, ideally, establish your own) for variables specific to your project.</p>
<p>All CMake variables are stored internally as <strong>strings</strong> although they may sometimes be interpreted as other types.</p>
<p>Use the <code>set</code> command to set variable values. In its simplest form, the first argument to <code>set</code> is the name of the variable and the rest of the arguments are the values. Multiple value arguments are packed into a semicolon-separated list and stored in the variable as a string. For example:</p>
<div class="language-cmake codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cmake codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">set(Foo &quot;&quot;)      # 1 quoted arg -&gt; value is &quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">set(Foo a)       # 1 unquoted arg -&gt; value is &quot;a&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">set(Foo &quot;a b c&quot;) # 1 quoted arg -&gt; value is &quot;a b c&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">set(Foo a b c)   # 3 unquoted args -&gt; value is &quot;a;b;c&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>set</code>命令, 简单的语法是变量名+参数/字符串, 如果输入多个参数会被拼接成以分号<code>;</code>分割符的一个字符串。</p>
<p>Variables may be referenced in command arguments using syntax <code>${VAR}</code> where <code>VAR</code> is the variable name.</p>
<p>If the named variable is not defined, the reference is replaced with an empty string; otherwise it is replaced by the value of the variable. Replacement is performed prior to the expansion of unquoted arguments, so variable values containing semicolons are split into zero-or-more arguments in place of the original unquoted argument.For example:</p>
<div class="language-cmake codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cmake codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">set(Foo a b c)    # 3 unquoted args -&gt; value is &quot;a;b;c&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">command(${Foo})   # unquoted arg replaced by a;b;c and expands to three arguments</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">command(&quot;${Foo}&quot;) # quoted arg value is &quot;a;b;c&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">set(Foo &quot;&quot;)       # 1 quoted arg -&gt; value is empty string</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">command(${Foo})   # unquoted arg replaced by empty string and expands to zero arguments</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">command(&quot;${Foo}&quot;) # quoted arg value is empty string</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>通过<code>${VAR}</code>可以调用变量，使用变量<code>VAR</code>的值<code>VALUE</code>。如果变量未被定义使用时会被<code>替换(replace)</code>成一个空字符串<code>&quot;&quot;</code>。且<code>替换</code>动作发生在VALUE的展开前，所以包含分号<code>;</code>的值<code>VALUE</code>是被拆分为多个参数后, 再替换<code>${VAR}</code></p>
<p><strong>System environment variables(系统环境变量)</strong> and <strong>Windows registry values(注册表值)</strong> can be accessed directly in CMake. To access system environment variables, use the syntax <code>$ENV{VAR}</code>. CMake can also reference registry entries in many commands using a syntax of the form <code>[HKEY_CURRENT_USER\\Software\\path1\\path2;key]</code>, where the paths are built from the registry tree and key.</p>
<p><code>$ENV{VAR}</code>可以直接读取环境变量。(注册表值没试过)</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="variable-scope">Variable Scope<a href="#variable-scope" class="hash-link" aria-label="Direct link to Variable Scope" title="Direct link to Variable Scope">​</a></h3>
<p>变量范围</p>
<p>Variables in CMake have a scope that is a little different from most languages. When you set a variable, it is visible to the current CMakeLists file or function and any subdirectory’s CMakeLists files, any functions or macros(宏) that are invoked(调用), and any files that are included using the <code>include</code> command.</p>
<p>When a new subdirectory is processed (or a function called), a new variable scope is created and initialized with the current value of all variables in the calling scope. Any new variables created in the child scope, or changes made to existing variables, will not impact the parent scope.</p>
<p>There is a way for CMake to return a value from a function, and it can be done by using the PARENT_SCOPE option with the set command.</p>
<div class="language-cmake codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cmake codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">function(foo)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> message(${test}) # test is 1 here</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> message(${test_2}) # test_2 is 1 here</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> set(test 2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> set(test_2 2 PARENT_SCOPE)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> message(${test}) # test is 2 here, but only in this scope</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> message(${test_2}) # test_1 still 1 in this scope</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">endfunction()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">set(test 1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">set(test_2 1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">foo()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">message(${test}) # test will still be 1 here</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">message(${test_2}) # test_2 will now be 2 here</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>CMakeLists.txt中设置的变量，在当前文件或函数、子目录文件、所有被调用的函数或宏、以及使用<code>include</code>命令引用的文件中可见。</p>
<p>子目录或函数中修改上一区域(parent scope)的变量, 只会影响当前区域该变量的值, 改变量在上一区域的使用时不受任何影响。</p>
<p>但如果在<code>set(VAR VALUE PARENT_SCPOE)</code>加入<code>PARENT_SCPOE</code>，就会修改该变量在上一区域的值，而不会修改当前区域。</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="commands指令">Commands(指令)<a href="#commands指令" class="hash-link" aria-label="Direct link to Commands(指令)" title="Direct link to Commands(指令)">​</a></h3>
<p>A command consists of the <strong>command name</strong>, <strong>opening parenthesis</strong>, <strong>whitespace separated arguments</strong>, and a <strong>closing parenthesis</strong>. Each command is evaluated in the order that it appears in the CMakeLists file. See the <a href="https://cmake.org/cmake/help/latest/manual/cmake-commands.7.html" target="_blank" rel="noopener noreferrer">cmake-commands</a> manual for a full list of CMake commands.</p>
<p>CMake is <strong>no longer case sensitive</strong> to command names, so where you see <code>command</code>, you could use <code>COMMAND</code> or <code>Command</code> instead.It is considered best practice to use lowercase commands.All whitespace (<strong>spaces</strong>, <strong>line feeds</strong>, <strong>tabs</strong>) is ignored except to separate arguments.Therefore, commands may span multiple lines as long as the command name and the opening parenthesis are on the same line.</p>
<p>与参数不同，命令对大小写不敏感。建议使用小写输入命令。命令中的空白都会被忽略（使用该特征可以执行命令中参数之间的换行等操作），但要保证命令名称与开始的左括号在同一行。</p>
<p>常见命令有：</p>
<ul>
<li>set, 设置普通变量、缓存变量、或环境变量</li>
<li>unset, 消除普通变量、缓存变量、或环境变量</li>
<li>string, 字符串操作, 包括查找替换(find, replace)、复杂操作(append, tolower, toupper, length...)、对比(compare)、哈希(hash)...</li>
<li>list, 列表操作, 包与string类似, 但操作对象不同</li>
<li>separate_arguments, 解析命令行参数</li>
<li>add_executable, 新增可执行文件</li>
<li>add_library, 新增库文件</li>
<li>...</li>
</ul>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="conditional-statements-if">Conditional Statements (if)<a href="#conditional-statements-if" class="hash-link" aria-label="Direct link to Conditional Statements (if)" title="Direct link to Conditional Statements (if)">​</a></h3>
<p>if, elseif, else的基本用法:</p>
<div class="language-cmake codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cmake codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">if(MSVC80)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # do something here</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">elseif(MSVC90)      </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # do something else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">elseif(APPLE)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # do something else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">else()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">endif()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>详细使用方法参考: <a href="https://cmake.org/cmake/help/latest/command/if.html#command:if" target="_blank" rel="noopener noreferrer">if</a></p>
<p>主要是对if判断条件语法(Condition Syntax)的拓展，包含</p>
<ul>
<li>基础字符的处理、</li>
<li>逻辑判断（Logic Operators: NOT, AND, OR...）</li>
<li>存在检查（Existence Checks）</li>
<li>文件判断（File Operations: EXISTS, IS_NEWER_THAN, IS_DIRECTORY, IS_SYMLINK, IS_ABSOLUTE..）</li>
<li>变量或字符的比较（MATCHES, LESS, GREATER, EQUAL, LESS_EQUAL...）</li>
<li>版本比较(Version Comparisons(暂时还没有仔细看&quot;版本比较&quot;是什么意思))</li>
</ul>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>应该还得有一个详细的解释或者示例</p></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="looping-constructs-foreach-while">Looping Constructs (foreach, while)<a href="#looping-constructs-foreach-while" class="hash-link" aria-label="Direct link to Looping Constructs (foreach, while)" title="Direct link to Looping Constructs (foreach, while)">​</a></h3>
<p>The foreach command enables you to execute a group of CMake commands repeatedly on the members of a list.</p>
<p>用foreach命令, 可以在for循环汇总, 使用同一个变量代替数组内的其他变量</p>
<div class="language-cmake codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cmake codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">foreach(tfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        TestAnisotropicDiffusion2D</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        TestButterworthLowPass</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        TestButterworthHighPass</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        TestCityBlockDistance</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        TestConvolve</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">message(&quot;tfile:&quot; ${tfile})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">endforeach()        </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>上述示例代码中, 将会执行5次循环, 第一次循环中<code>${tfile}</code>为TestAnisotropicDiffusion2D, 第二次循环中<code>${tfile}</code>是TestButterworthLowPass... 一次类推</p>
<p>foreach可以用于嵌套, 比如: (设想的应用场景)</p>
<div class="language-cmake codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cmake codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">foreach(package OpenMP GDAL Eigen3 fmt)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">find_package(${package} CONFIG REQUIRED)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if(NOT ${package}_FOUND)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">message(FATAL_ERROR &quot;${package} not found!&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">endif()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">endforeach()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>搜索各个库, 搜索不到的话就报错退出。</p>
<p>foreach的详细用法参考：<a href="https://cmake.org/cmake/help/latest/command/foreach.html#command:foreach" target="_blank" rel="noopener noreferrer">foreach</a></p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>应该还得有一个详细的解释或者示例</p></div></div>
<p>while用法是当满足判断条件时执行循环操作, 直到不满足判断条件为止。语法形如：</p>
<div class="language-cmake codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cmake codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">while(&lt;condition&gt;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;commands&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">endwhile()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>&lt;condition&gt;</code>的语法与<code>if(&lt;condition&gt;)endif()</code>相同。</p>
<p>The commands break() and continue() provide means to escape from the normal control flow.</p>
<p>while中提供了<code>break()</code>和<code>continue()</code>两个指令, 来跳出和跳过当前循环, 用法与C++近似。</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="procedure-definitions-macro-function">Procedure definitions (macro, function)<a href="#procedure-definitions-macro-function" class="hash-link" aria-label="Direct link to Procedure definitions (macro, function)" title="Direct link to Procedure definitions (macro, function)">​</a></h3>
<p>The main differences (between <code>macro</code> and <code>function</code>) are that a macro does not push and pop a new variable scope, and that the arguments to a macro are not treated as variables but as strings replaced prior to execution.</p>
<p><code>macro</code>和<code>function</code>的区别与C++中宏和函数的区别类似，<code>macro</code>可以理解  为将一段代码进行替换, 而<code>function</code>则是开辟一块新的空间，在空间内部执行相应指令，即function内部变量的改动不会改变其在function外部的值。所以，如果想在function中设置变量，且希望其在function结束后仍然生效，需要添加<code>PARENT_SCOPE</code>指令，即<code>set(${var} &quot;value&quot; PARENT_SCOPE)</code>。</p>
<p>参数( ARGC, ARGV, ARGV#i, ARGN)</p>
<ul>
<li><code>${ARGC}</code>, the number of arguments passed into the function (macro), 输入的参数个数</li>
<li><code>${ARGV}</code>, A list of all arguments given to the function (macro)， 所有参数(不包含超过定义参数个数的可变参数, 即ARGN部分)</li>
<li><code>${ARGV#i}</code>, ARGV0 represents the first argument to the macro, 第i个参数</li>
<li><code>${ARGN}</code>, a list of all the arguments after the formal arguments, 所有超过定义参数格式之后的可变参数</li>
</ul>
<div class="language-cmake codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cmake codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">macro(regist mas sla)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  message(STATUS ARGC=${ARGC})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  message(STATUS ARGV=${ARGV})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  message(STATUS ARGN=${ARGN})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  message(STATUS ARGV0=${ARGV0})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  message(STATUS ARGV1=${ARGV1})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  message(STATUS ARGV2=${ARGV2})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  message(STATUS ARGV3=${ARGV3})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">endmacro()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">regist(mas sla aux)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 输出:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[cmake] -- ARGC=3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[cmake] -- ARGV=masslaaux</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[cmake] -- ARGN=aux</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[cmake] -- ARGV0=mas</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[cmake] -- ARGV1=sla</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[cmake] -- ARGV2=aux</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[cmake] -- ARGV3=</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The <code>return</code> command returns from a function, directory or file.</p>
<p><code>return</code>命令可以返回一个函数、目录或文件。由于<code>macro</code>和<code>function</code>的机制不同（<code>macro</code>没有开辟新空间而是原地展开/替换）, <code>macro</code>不能使用<code>return</code>指令。</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="regular-expressions">Regular Expressions<a href="#regular-expressions" class="hash-link" aria-label="Direct link to Regular Expressions" title="Direct link to Regular Expressions">​</a></h3>
<p>Since there are several different conventions for specifying regular expressions, CMake’s standard is described in the string command documentation. The description is based on the open source regular expression class from Texas Instruments, which is used by CMake for parsing regular expressions.</p>
<p>CMake的正则表达式使用的是 <strong>Texas Instruments</strong>的标准，详情需要参考<a href="https://cmake.org/cmake/help/latest/command/string.html#command:string" target="_blank" rel="noopener noreferrer">string</a>。</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="advanced-commands">Advanced Commands<a href="#advanced-commands" class="hash-link" aria-label="Direct link to Advanced Commands" title="Direct link to Advanced Commands">​</a></h3>
<p>There are a few commands that can be very useful, but are not typically used in writing CMakeLists files. This section will discuss a few of these commands and when they are useful.</p>
<p>介绍了几个不常用但在特定情况下非常有用的指令。</p>
<p><a href="https://cmake.org/cmake/help/latest/command/add_dependencies.html#command:add_dependencies" target="_blank" rel="noopener noreferrer">add_dependencies</a></p>
<p>Makes a top-level <code>target</code> depend on other top-level targets to ensure that they build before <code>target</code> does. A top-level target is one created by one of the <code>add_executable()</code>, <code>add_library()</code>, or <code>add_custom_target()</code> commands (but not targets generated by CMake like <code>install</code>).</p>
<p>作用是在两个&quot;top-level&quot;的目标(targets)之间建立关系，top-level是可执行文件(executable), 库(library)或custom_target( a target with no output so it will always be built)。</p>
<p><a href="https://cmake.org/cmake/help/latest/command/include_regular_expression.html#command:include_regular_expression" target="_blank" rel="noopener noreferrer">include_regular_expression</a></p>
<p>Set the regular expression used for dependency checking.</p>
<div class="language-cmake codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cmake codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">include_regular_expression(regex_match [regex_complain])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">regex_match    = &quot;^.*$&quot; (match everything)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">regex_complain = &quot;^$&quot; (match empty string only)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="cmake-cache">CMake Cache<a href="#cmake-cache" class="hash-link" aria-label="Direct link to CMake Cache" title="Direct link to CMake Cache">​</a></h2>
<p>The CMake cache may be thought of as a configuration file. The first time CMake is run on a project, it produces a CMakeCache.txt file in the top directory of the build tree. CMake uses this file to store a set of global cache variables, whose values persist across multiple runs within a project build tree.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="key-concepts">Key Concepts<a href="#key-concepts" class="hash-link" aria-label="Direct link to Key Concepts" title="Direct link to Key Concepts">​</a></h2>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="policies">Policies<a href="#policies" class="hash-link" aria-label="Direct link to Policies" title="Direct link to Policies">​</a></h2>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="modules">Modules<a href="#modules" class="hash-link" aria-label="Direct link to Modules" title="Direct link to Modules">​</a></h2>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="installing-files">Installing Files<a href="#installing-files" class="hash-link" aria-label="Direct link to Installing Files" title="Direct link to Installing Files">​</a></h2>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="system-inspection">System Inspection<a href="#system-inspection" class="hash-link" aria-label="Direct link to System Inspection" title="Direct link to System Inspection">​</a></h2>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="finding-packages">Finding Packages<a href="#finding-packages" class="hash-link" aria-label="Direct link to Finding Packages" title="Direct link to Finding Packages">​</a></h2>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="custom-commands">Custom Commands<a href="#custom-commands" class="hash-link" aria-label="Direct link to Custom Commands" title="Direct link to Custom Commands">​</a></h2>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="converting-existing-systems-to-cmake">Converting Existing Systems To CMake<a href="#converting-existing-systems-to-cmake" class="hash-link" aria-label="Direct link to Converting Existing Systems To CMake" title="Direct link to Converting Existing Systems To CMake">​</a></h2>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="cross-compiling-with-cmake">Cross Compiling With CMake<a href="#cross-compiling-with-cmake" class="hash-link" aria-label="Direct link to Cross Compiling With CMake" title="Direct link to Cross Compiling With CMake">​</a></h2>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="packaging-with-cpack">Packaging With CPack<a href="#packaging-with-cpack" class="hash-link" aria-label="Direct link to Packaging With CPack" title="Direct link to Packaging With CPack">​</a></h2>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="testing-with-cmake-and-ctest">Testing With CMake and CTest<a href="#testing-with-cmake-and-ctest" class="hash-link" aria-label="Direct link to Testing With CMake and CTest" title="Direct link to Testing With CMake and CTest">​</a></h2>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="cdash">CDash<a href="#cdash" class="hash-link" aria-label="Direct link to CDash" title="Direct link to CDash">​</a></h2>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="cmake-tutorial">CMake Tutorial<a href="#cmake-tutorial" class="hash-link" aria-label="Direct link to CMake Tutorial" title="Direct link to CMake Tutorial">​</a></h2>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="user-interaction-guide">User Interaction Guide<a href="#user-interaction-guide" class="hash-link" aria-label="Direct link to User Interaction Guide" title="Direct link to User Interaction Guide">​</a></h2>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="using-dependencies-guide">Using Dependencies Guide<a href="#using-dependencies-guide" class="hash-link" aria-label="Direct link to Using Dependencies Guide" title="Direct link to Using Dependencies Guide">​</a></h2>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="importing-and-exporting-guide">Importing and Exporting Guide<a href="#importing-and-exporting-guide" class="hash-link" aria-label="Direct link to Importing and Exporting Guide" title="Direct link to Importing and Exporting Guide">​</a></h2>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ide-integration-guide">IDE Integration Guide<a href="#ide-integration-guide" class="hash-link" aria-label="Direct link to IDE Integration Guide" title="Direct link to IDE Integration Guide">​</a></h2></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/category/cmake"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">CMake</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/code/cmake/cmake_find_package"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">find_package</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#getting-started" class="table-of-contents__link toc-highlight">Getting Started</a><ul><li><a href="#hello-world-for-cmake" class="table-of-contents__link toc-highlight">Hello World for CMake</a></li><li><a href="#configure-and-generate" class="table-of-contents__link toc-highlight">Configure and Generate</a></li><li><a href="#specifying-the-compiler-to-cmake" class="table-of-contents__link toc-highlight">Specifying the Compiler to CMake</a></li><li><a href="#build-configurations" class="table-of-contents__link toc-highlight">Build Configurations</a></li><li><a href="#building-your-project" class="table-of-contents__link toc-highlight">Building Your Project</a></li><li><a href="#总结" class="table-of-contents__link toc-highlight">总结</a></li></ul></li><li><a href="#writing-cmakelists-files" class="table-of-contents__link toc-highlight">Writing CMakeLists Files</a><ul><li><a href="#comments注释" class="table-of-contents__link toc-highlight">Comments(注释)</a></li><li><a href="#variables变量" class="table-of-contents__link toc-highlight">variables(变量)</a></li><li><a href="#variable-scope" class="table-of-contents__link toc-highlight">Variable Scope</a></li><li><a href="#commands指令" class="table-of-contents__link toc-highlight">Commands(指令)</a></li><li><a href="#conditional-statements-if" class="table-of-contents__link toc-highlight">Conditional Statements (if)</a></li><li><a href="#looping-constructs-foreach-while" class="table-of-contents__link toc-highlight">Looping Constructs (foreach, while)</a></li><li><a href="#procedure-definitions-macro-function" class="table-of-contents__link toc-highlight">Procedure definitions (macro, function)</a></li><li><a href="#regular-expressions" class="table-of-contents__link toc-highlight">Regular Expressions</a></li><li><a href="#advanced-commands" class="table-of-contents__link toc-highlight">Advanced Commands</a></li></ul></li><li><a href="#cmake-cache" class="table-of-contents__link toc-highlight">CMake Cache</a></li><li><a href="#key-concepts" class="table-of-contents__link toc-highlight">Key Concepts</a></li><li><a href="#policies" class="table-of-contents__link toc-highlight">Policies</a></li><li><a href="#modules" class="table-of-contents__link toc-highlight">Modules</a></li><li><a href="#installing-files" class="table-of-contents__link toc-highlight">Installing Files</a></li><li><a href="#system-inspection" class="table-of-contents__link toc-highlight">System Inspection</a></li><li><a href="#finding-packages" class="table-of-contents__link toc-highlight">Finding Packages</a></li><li><a href="#custom-commands" class="table-of-contents__link toc-highlight">Custom Commands</a></li><li><a href="#converting-existing-systems-to-cmake" class="table-of-contents__link toc-highlight">Converting Existing Systems To CMake</a></li><li><a href="#cross-compiling-with-cmake" class="table-of-contents__link toc-highlight">Cross Compiling With CMake</a></li><li><a href="#packaging-with-cpack" class="table-of-contents__link toc-highlight">Packaging With CPack</a></li><li><a href="#testing-with-cmake-and-ctest" class="table-of-contents__link toc-highlight">Testing With CMake and CTest</a></li><li><a href="#cdash" class="table-of-contents__link toc-highlight">CDash</a></li><li><a href="#cmake-tutorial" class="table-of-contents__link toc-highlight">CMake Tutorial</a></li><li><a href="#user-interaction-guide" class="table-of-contents__link toc-highlight">User Interaction Guide</a></li><li><a href="#using-dependencies-guide" class="table-of-contents__link toc-highlight">Using Dependencies Guide</a></li><li><a href="#importing-and-exporting-guide" class="table-of-contents__link toc-highlight">Importing and Exporting Guide</a></li><li><a href="#ide-integration-guide" class="table-of-contents__link toc-highlight">IDE Integration Guide</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__links text--center"><div class="footer__links"><a class="footer__link-item" href="/">Home</a><span class="footer__link-separator">·</span><a class="footer__link-item" href="/docs/intro">Document</a><span class="footer__link-separator">·</span><a class="footer__link-item" href="/docs/code/intro">Code</a><span class="footer__link-separator">·</span><a class="footer__link-item" href="/blog">Blog</a><span class="footer__link-separator">·</span><a href="https://github.com/li-tann/li-tann.github.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 li-tann's notebook, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>